CREATE ALGORITHM=UNDEFINED DEFINER=`jv`@`%` SQL SECURITY DEFINER VIEW `windowtwo` AS select `windowtwo`.`row_num_amount` AS `row_num_amount`,`windowtwo`.`month` AS `month`,`windowtwo`.`nameItem` AS `nameItem`,`windowtwo`.`quantity` AS `quantity`,`windowtwo`.`totalAmount` AS `totalAmount` from (select row_number() over ( partition by `mainrequest`.`month` order by `mainrequest`.`totalAmount` desc) AS `row_num_amount`,`mainrequest`.`month` AS `month`,`mainrequest`.`nameItem` AS `nameItem`,`mainrequest`.`quantity` AS `quantity`,`mainrequest`.`totalAmount` AS `totalAmount` from `meli`.`mainrequest`) `windowtwo` where `windowtwo`.`row_num_amount` = 1