CREATE ALGORITHM=UNDEFINED DEFINER=`jv`@`%` SQL SECURITY DEFINER VIEW `windowone` AS select `windowone`.`row_num` AS `row_num`,`windowone`.`month` AS `month`,`windowone`.`nameItem` AS `nameItem`,`windowone`.`quantity` AS `quantity`,`windowone`.`totalAmount` AS `totalAmount` from (select row_number() over ( partition by `mainrequest`.`month` order by `mainrequest`.`quantity` desc) AS `row_num`,`mainrequest`.`month` AS `month`,`mainrequest`.`nameItem` AS `nameItem`,`mainrequest`.`quantity` AS `quantity`,`mainrequest`.`totalAmount` AS `totalAmount` from `meli`.`mainrequest`) `windowone` where `windowone`.`row_num` = 1